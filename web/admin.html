<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>BibleApp: Admin</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta content="A fully featured admin theme which can be used to build CRM, CMS, etc." name="description" />
    <meta content="Coderthemes" name="author" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <!-- App favicon -->
    <link rel="shortcut icon" href="assets/images/favicon.ico">

    <!-- DataTables -->
    <link href="assets/libs/datatables.net-bs4/css/dataTables.bootstrap4.min.css" rel="stylesheet" type="text/css"/>
    <link href="assets/libs/datatables.net-responsive-bs4/css/responsive.bootstrap4.min.css" rel="stylesheet" type="text/css"/>
    <link href="assets/libs/datatables.net-buttons-bs4/css/buttons.bootstrap4.min.css" rel="stylesheet" type="text/css" />
    <link href="assets/libs/datatables.net-select-bs4/css/select.bootstrap4.min.css" rel="stylesheet" type="text/css" />

    <!-- Icons css -->
    <link href="assets/libs/@mdi/font/css/materialdesignicons.min.css" rel="stylesheet" type="text/css" />
    <link href="assets/libs/dripicons/webfont/webfont.css" rel="stylesheet" type="text/css" />
    <link href="assets/libs/simple-line-icons/css/simple-line-icons.css" rel="stylesheet" type="text/css" />

    <!-- App css -->
    <!-- build:css -->
    <link href="assets/css/app.css" rel="stylesheet" type="text/css" />

</head>

<body>

<!-- Begin page -->
<div id="wrapper">

  <!-- Navigation Bar-->
<header id="topnav">
    <nav class="navbar-custom">
        <ul class="list-unstyled topbar-right-menu float-right mb-0">

            <li class="dropdown notification-list">
                <a class="nav-link dropdown-toggle nav-user" data-toggle="dropdown" href="#" role="button"
                   aria-haspopup="false" aria-expanded="false">
                    <img src="assets/images/users/avatar-1.jpg" alt="user" class="rounded-circle"> <span class="ml-1">Administrator <i class="mdi mdi-chevron-down"></i> </span>
                </a>
                <div class="dropdown-menu dropdown-menu-right dropdown-menu-animated profile-dropdown ">
                    <!-- item-->
                    <div class="dropdown-item noti-title">
                        <h6 class="text-overflow m-0">Welcome !</h6>
                    </div>


                    <!-- item-->
                    <a href="logout.php" class="dropdown-item notify-item">
                        <i class="dripicons-power"></i> <span>Logout</span>
                    </a>

                </div>
            </li>

        </ul>

        <ul class="list-unstyled menu-left mb-0">
            <li class="float-left">
                <a href="index" class="logo">
                                <span class="logo-lg">
                                    BibleApp
                                </span>
                    <span class="logo-sm">
                    BibleApp
                                </span>
                </a>
            </li>
            <li class="float-left">
                <a class="button-menu-mobile open-left navbar-toggle">
                    <div class="lines">
                        <span></span>
                        <span></span>
                        <span></span>
                    </div>
                </a>
            </li>
            <li class="app-search">
                <form>
                    <input type="text" placeholder="Search..." class="form-control">
                    <button type="submit" class="sr-only"></button>
                </form>
            </li>
        </ul>
    </nav>
    <!-- end navbar-custom -->
</header>
<!-- End Navigation Bar-->

<!-- ========== Left Sidebar Start ========== -->
<div class="left-side-menu">

    <div class="slimscroll-menu">

        <!--- Sidemenu -->
        <div id="sidebar-menu">

            <ul class="metismenu" id="side-menu">

                <li class="menu-title">Navigation</li>

                <li>
                    <a href="index.html">Books</a>
                 </li>
                 <li>
                   <a href="addbook.html">Add book</a>
                </li>
                 <li><a href="admin.html">Admins </a></li>
                 <li><a href="logout.html">Log out </a></li>
                 


            </ul>

        </div>
        <!-- Sidebar -->

        <div class="clearfix"></div>

    </div>
    <!-- Sidebar -left -->

</div>
<!-- Left Sidebar End -->
 

    <!-- Page Content Start -->
    <div class="content-page">
        <div class="content">
            <div class="container-fluid">

                <!-- Page title box -->
                <div class="page-title-box">
                    <ol class="breadcrumb float-right">

                        <li class="breadcrumb-item"><a href="admin.html">Admin</a></li>
                        <li class="breadcrumb-item active">Admin</li>
                    </ol>
                    <h4 class="page-title">Edit Admin</h4>
                </div>
                <!-- End page title box -->

          

                <!-- end row -->
                <div class="row">
                    <div class="col-md-12">
                        <div class="card-box">


                 
                                <div class="form-row">


                                    <div class="form-group col-md-3">
                                    </div>

                                    <div class="form-group col-md-6">
                                        <label class="control-label mb-10 text-left">Username </label>
                                        <input type="" id='username' class="form-control" value="" >
                                        <input  name='id' class="form-control" style="display:none" value="<?php echo $row['id']; ?>" >
                                    </div>

                                    <div class="form-group col-md-3">

                                    </div>
                                </div>
                                <div class="form-row">


                                    <div class="form-group col-md-3">
                                    </div>

                                    <div class="form-group col-md-6">
                                        <label class="control-label mb-10 text-left">Password</label>
                                        <input type="" id='password' class="form-control" value=""  re adonly>
                                    </div>
                                    <div class="form-group col-md-3">

                                    </div>
                                </div>
                               
                                <div class="form-row">


                                    <div class="form-group col-md-3">
                                    </div>

                                    <div class="form-group col-md-3">

                                    </div>
                                </div>

                                <div class="form-row">


                                    
                                </div>

                                 




                                <div class="form-row">
                                    <div class="form-group col-md-3">

                                    </div>
 
                                    <div class="form-group col-md-6">
                                        <button onclick="butModify()" type="submit" id="modify"  class="btn btn-primary btn-block">Submit</button>
                                    </div>

                                    <div class="form-group col-md-3">

                                    </div>
                                </div>
                                <script>
                                    //load all login details
                                    function loadAll() {
                                        const data = {
                                            id:localStorage.getItem('key') || ""
                                        }
                                         
                                        fetch("/getadmin", {
                                                method: 'POST', // *GET, POST, PUT, DELETE, etc.
                                                mode: 'cors', // no-cors, *cors, same-origin
                                                cache: 'no-cache', // *default, no-cache, reload, force-cache, only-if-cached
                                                headers: {
                                                'Content-Type': 'application/json'
                                                // 'Content-Type': 'application/x-www-form-urlencoded',
                                                },
                                                body:JSON.stringify(data)
                                        }).then((response) => response.json()
                                            .then((data) => { console.log(data)
                                                if(data.status == true) {
                                                    document.getElementById('username').value = data.dat.name
                                                    document.getElementById('password').value = ""
                                                     
                                                }
                                                else if(data.status == false) {
                                                    if(data.msg.indexOf('invalid session') > -1) {
                                                        //go back to login
                                                        window.location = 'login.html'
                                                    }
                                                }
                                            }))
                                            .catch(err => {
                                                //console.log(err)
                                                //reload after two sec
                                                setTimeout(() => {loadAll()}, 2000)
                                            })
                                    }
                                    loadAll()

                                    function butModify(){
                                                // document.getElementById("btnlogin").setAttribute("disabled", "disabled");
                                                var name = document.getElementById("username").value;
                                                var password = document.getElementById("password").value.trim();
                                                if(password != "") {
                                                    const data = {
                                                        data:{name:name,pass:password},id:localStorage.getItem('key') || ""
                                                    }
                                                    document.getElementById("modify").disabled = true
                                                    document.getElementById("modify").innerHTML = "Submitting in...."
                                                    fetch("/modifyadmin", {
                                                        method: 'POST', // *GET, POST, PUT, DELETE, etc.
                                                        mode: 'cors', // no-cors, *cors, same-origin
                                                        cache: 'no-cache', // *default, no-cache, reload, force-cache, only-if-cached
                                                        headers: {
                                                        'Content-Type': 'application/json'
                                                        },
                                                        body: JSON.stringify(data)// body data type must match "Content-Type" header
                                                    }).then((response) => response.json()
                                                    .then((data) => { console.log(data)
                                                        document.getElementById("modify").disabled = false
                                                        document.getElementById("modify").innerHTML = "Submitting In"
                                                    
                                                        if(data.status == true){
                                                            alert("Modified");
                                                        }else if(data.status==false){
                                                            alert(data.msg);
                                                        }
                                                        else {  
                                                            alert("Something went wrong");
                                                        }
                                                    }))
                                                    .catch(err => { console.log(err)
                                                        document.getElementById("modify").disabled = false
                                                        document.getElementById("modify").innerHTML = "Submit"
                                                        alert('Network error')
                                                    })
                                                }else {
                                                    alert("Password field cannot be empty")
                                                }


                                                }

                                </script>
            
                                <div class="form-row">
                                    <div class="form-group col-md-3">

                                    </div>

                                    <div class="form-group col-md-6">




                                    </div>

                                    <div class="form-group col-md-3">

                                    </div>
                                </div>

                            

                        </div> <!-- end card-box -->
                    </div> <!-- end col -->
                </div>
                <!-- end row -->


            </div> <!-- end container-fluid-->
        </div> <!-- end contant-->
    </div>
    <!-- End Page Content-->



    <footer class="footer">
        <div class="container-fluid">
            <div class="row">
                <div class="col-12 text-center">
                    2018 Â© Greeva. - Coderthemes.com
                </div>
            </div>
        </div>
    </footer>






</div>






</body>
</html>
<!-- jQuery  -->
<script src="assets/libs/jquery/jquery.min.js"></script>
<script src="assets/libs/bootstrap/js/bootstrap.bundle.min.js"></script>
<script src="assets/libs/jquery-slimscroll/jquery.slimscroll.min.js"></script>
<script src="assets/libs/metismenu/metisMenu.min.js"></script>

<!-- Datatable js -->
<script src="assets/libs/datatables.net/js/jquery.dataTables.min.js"></script>
<script src="assets/libs/datatables.net-bs4/js/dataTables.bootstrap4.min.js"></script>
<script src="assets/libs/datatables.net-responsive/js/dataTables.responsive.min.js"></script>
<script src="assets/libs/datatables.net-responsive-bs4/js/responsive.bootstrap4.min.js"></script>
<!-- Buttons examples -->
<script src="assets/libs/datatables.net-buttons/js/dataTables.buttons.min.js" type="text/javascript"></script>
<script src="assets/libs/datatables.net-buttons/js/buttons.html5.min.js" type="text/javascript"></script>
<script src="assets/libs/datatables.net-buttons/js/buttons.flash.min.js" type="text/javascript"></script>
<script src="assets/libs/datatables.net-buttons/js/buttons.print.min.js" type="text/javascript"></script>
<script src="assets/libs/datatables.net-buttons/js/buttons.colVis.min.js" type="text/javascript"></script>
<script src="assets/libs/datatables.net-buttons-bs4/js/buttons.bootstrap4.min.js" type="text/javascript"></script>
<!-- Key Tables -->
<script src="assets/libs/datatables.net-keytable/js/dataTables.keyTable.min.js"></script>
<!-- Selection table -->
<script src="assets/libs/datatables.net-select/js/dataTables.select.min.js"></script>

<!-- App js -->
<script src="assets/js/jquery.core.js"></script>
<script src="assets/js/jquery.app.js"></script>

<script type="text/javascript">
    $(document).ready(function() {

        // Default Datatable
        $('#datatable').DataTable({
            keys: true
        });

        //Buttons examples
        var table = $('#datatable-buttons').DataTable({
            lengthChange: false,
            buttons: ['copy', 'print']
        });

        // Multi Selection Datatable
        $('#selection-datatable').DataTable({
            select: {
                style: 'multi'
            }
        });

        table.buttons().container()
            .appendTo('#datatable-buttons_wrapper .col-md-6:eq(0)');
    } );

</script>
